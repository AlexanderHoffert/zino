var Zino=function(){"use strict";function t(t){for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.forEach(function(n){for(var r in n)("undefined"!=typeof HTMLElement&&n instanceof HTMLElement||void 0!==e(n,r).value&&(!t[r]||e(t,r).writable))&&(t[r]=n[r])}),t}function e(t,e){return S(t)&&Object.getOwnPropertyDescriptor(t,e)||{}}function n(t,e,n){throw n?new Error("Error while calling "+t+" function of "+e+": "+(n.message||n),n.fileName,n.lineNumber):(n=e,new Error(t+": "+(n.message||n),n.fileName,n.lineNumber))}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}function a(t,e){if($[t])for(var n in $[t]){var r=$[t][n](e);if(!1===r)break}}function o(t,e){$[t]||($[t]=[]),$[t].push(e)}function i(t,e){if(!z(e))return void delete $[t];for(var n in $[t])if($[t][n]===e)return void delete $[t][n]}function c(t,e){o(t,function n(){e.apply(this,arguments),i(t,n)})}function u(t,e,n){if(z(t.addEventListener)){var r=function(e,r){for(var a=[].slice.call(t.querySelectorAll(e));a.length>0&&r!==n;){if(a.indexOf(r)>=0)return a[a.indexOf(r)];r=r.parentNode}return!1};e.forEach(function(e){Object.keys(e.handlers).forEach(function(a){t.addEventListener(a,function(t){var o=void 0;(":host"===e.selector||(o=r(e.selector,t.target)))&&(o&&(o.getHost=function(){return n.getHost()}),e.handlers[a].call(o||n,t))},!1)})})}}function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function l(t){q=t}function f(t,e,n){t=t.toLowerCase();var r={tagName:t,attributes:e||{},children:n||[]};return M.indexOf(t)>=0&&F.push(r),r}function d(t,e){var n=[];return t=(t||"").toLowerCase(),"function"==typeof e.getElementsByTagName?[].slice.call(e.getElementsByTagName(t)):(e.children&&(n=n.concat(e.children.filter(function(e){return e.tagName&&e.tagName.toLowerCase()===t})),e.children.forEach(function(e){n=n.concat(d(t,e))})),n)}function h(t){M=t}function g(){var t=F;return F=[],t}function p(t){return t.children?(s(t.children)||(t.children=[t.children]),(s(t)&&t||t.children).map(function(t){if("object"!==(void 0===t?"undefined":k(t)))return""+t;if(s(t))return p(t);var e=[""].concat(Object.keys(t.attributes).map(function(e){return"object"===k(t.attributes[e])?e+'="--'+q(e,t.attributes[e])+'--"':e+'="'+t.attributes[e]+'"'}));return"<"+t.tagName+e.join(" ")+">"+p(t)+"</"+t.tagName+">"}).join("")):""}function m(t,e){var n=void 0;return"object"!==(void 0===t?"undefined":k(t))?n=e.createTextNode(""+t):(n=e.createElement(t.tagName),Object.keys(t.attributes).forEach(function(e){n.setAttribute(e,t.attributes[e])}),t.__vdom&&a("--zino-initialize-node",{tag:n,node:t}),n.innerHTML=p(t)),n}function v(t,e,n){s(e)||(s(e.children)||(e.children=[e.children]),e.tagName!==t.tagName.toLowerCase()?t.parentNode.replaceChild(m(e,n),t):(Object.keys(e.attributes).forEach(function(n){if("object"!==k(e.attributes[n]))t.getAttribute(n)!=e.attributes[n]&&t.setAttribute(n,e.attributes[n]);else if(t.getAttribute(n)&&t.getAttribute(n).match(/^--|--$/g)){var r=q(n,e.attributes[n],t.getAttribute(n).replace(/^--|--$/g,""));t.setAttribute(n,"--"+r+"--")}}),t.attributes.length>Object.keys(e.attributes)&&[].forEach.call(t.attributes,function(n){void 0===e.attributes[n.name]&&t.removeAttribute(n.name)})));var r=s(e)?e:e.children;r.forEach(function(e,r){if(s(e))return v(t,e,n);void 0===t.childNodes[r]?t.appendChild(m(e,n)):3===t.childNodes[r].nodeType?"string"==typeof e&&t.childNodes[r].nodeValue!==e?t.childNodes[r].nodeValue=e:"string"!=typeof e&&t.replaceChild(m(e,n),t.childNodes[r]):1===t.childNodes[r].nodeType&&("object"===(void 0===e?"undefined":k(e))?v(t.childNodes[r],e,n):t.replaceChild(m(e,n),t.childNodes[r]))}),t.childNodes.length>r.length&&[].slice.call(t.childNodes,r.length).forEach(function(e){return t.removeChild(e)})}function b(e,n){var r=e(f),a=r.tagName;D[a]||(L(r),r.functions=t({},U,r.functions),D[a]=r,n&&[].slice.call(d(a,n)).forEach(function(t){return w(t,D[a])}))}function y(t,e){if(t.tagName){var n=D[t.tagName.toLowerCase()];if(n&&!t.getAttribute("__ready"))return e&&(n.functions.render=H),w.call(e?{noEvents:!0}:this,t,n)}}function x(t){_(N(t),t)}function w(t,e){if(!t.__vdom&&e){var n=e.functions,r=void 0;if(t.children.length>0&&t.children[0].attributes&&"-shadow-root"===t.children[0].attributes.class){var o=t.children[1];o&&"-original-root"===o.className&&(t.__i=o.innerHTML,O(o,t),o.parentNode.removeChild(o)),r=!0}else t.__i=t.ownerDocument?t.innerHTML:p(t),O(t),t.innerHTML='<div class="-shadow-root"></div>';a("--zino-initialize-node",{tag:t,node:n}),t.__vdom={};var i=!r&&N.call(this,t)||{events:[]},c=[],u=n.events||[],s=Object.keys(u).filter(function(e){var n=":host"!==e&&e!==t.tagName;return n||c.push({handlers:u[e],selector:e}),n}).map(function(t){return{selector:t,handlers:u[t]}});if(i.events=i.events.concat({childEvents:s,hostEvents:c,tag:this&&this.noEvents?t.tagName:t}),t.attributes.__ready||(z(t.__s)?t.__s("__ready",!0):t.attributes.__ready=!0),this&&!0===this.noEvents)return i;_(i,t)}}function E(e){var r=e.tag,o=e.node;for(var i in o){var c=o[i];["mount","unmount","events","render"].indexOf(i)<0&&(z(c)?r[i]=c.bind(r):r[i]=c)}if(Object.defineProperty(r,"body",{set:function(t){r.__i=t,O(r),a("--zino-rerender-tag",r.getHost())},get:function(){return r.__i}}),r.__s=r.setAttribute,r.setAttribute=function(t,e){z(this.__s)?this.__s(t,e):this.attributes[t]=e,a("--zino-rerender-tag",this)},r.props=t({},o.props,A(r,!0)),r.ownerDocument)try{r.mounting=!0,o.mount.call(r),delete r.mounting}catch(t){n("mount",r.tagName,t)}}function N(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D[e.tagName.toLowerCase()],o=[],i=[],c=[],u=void 0;l(R.resolveData);var s=A(e);if(!z(r.render))throw new Error("No render function provided in component "+e.tagName);return h(Object.keys(D)),u=f("div",{class:"-shadow-root"},r.render.call(e,s)),c=c.concat(g()),c.forEach(function(t){var e=w.call({noRenderCallback:!0,noEvents:!0},t,D[t.tagName]);c=c.concat(g()),o=o.concat(e.events),i=i.concat(e.renderCallbacks)}),e.attributes.__ready&&e.ownerDocument?v(e.children[0],u,e.ownerDocument):e.ownerDocument?e.children[0].innerHTML=p(u):e.children[0]=u,e.__vdom=u,e.__subElements=c,c.length>0&&(e.querySelectorAll&&[].slice.call(e.querySelectorAll("[__ready]"))||c).forEach(function(e,r){if(t(e,c[r]),e.ownerDocument)try{e.mounting=!0,D[e.tagName.toLowerCase()].functions.mount.call(e),delete e.mounting}catch(t){n("mount",e.tagName,t)}c[r].getHost=U.getHost.bind(e),e.setAttribute=function(t,n){HTMLElement.prototype.setAttribute.call(e,t,n),a("--zino-rerender-tag",e)}}),this&&this.noRenderCall?i.push(r.functions.render.bind(e)):(i.forEach(function(t){return t()}),r.functions.render.call(e)),{events:o,renderCallbacks:i,data:s}}function _(t,e){var n={};t.events.forEach(function(t){var r=t.tag;S(r)||(n[r]=(n[r]||0)+1,r=e.querySelectorAll(r)[n[r]-1]),r.children[0].__eventsAttached||(u(r.children[0],t.childEvents,r),u(r,t.hostEvents,r),r.children[0].__eventsAttached=!0),z(r.onready)&&r.onready()})}function j(t){var e=(t.tagName||"").toLowerCase(),r=D[e];if(r){[].forEach.call(1===t.nodeType&&t.attributes||Object.keys(t.attributes).map(function(e){return{name:e,value:t.attributes[e]}}),function(t){t.name.indexOf("data-")>=0&&delete V[t.value]});try{r.functions.unmount.call(t)}catch(t){n("Unable to unmount tag "+e,t)}}}function A(t,e){var n={props:t.props,element:t.element,styles:t.styles,body:t.__i},r={};return[].forEach.call(1===t.nodeType&&t.attributes||Object.keys(t.attributes).map(function(e){return{name:e,value:t.attributes[e]}}),function(t){var e=t.name.indexOf("data-")>=0&&"string"==typeof t.value&&"--"===t.value.substr(0,2);n[t.name]||(n[t.name]=e?V[t.value.replace(/^--|--$/g,"")]:t.value),0===t.name.indexOf("data-")&&(r[t.name.replace(/^data-/g,"").replace(/(\w)-(\w)/g,function(t,e,n){return e+n.toUpperCase()})]=n[t.name])}),e?r:n}function O(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n={};[].forEach.call(t.children,function(t){if(t.tagName){var e=t.tagName.toLowerCase();n[e]?(n[e].isArray||(n[e]=[n[e]],n[e].isArray=!0),n[e].push(t)):n[e]=t}}),e.element=n}function L(t){var e=t.tagName;a("publish-style",(t.styles||[]).map(function(t){return t.replace(/[\r\n]*([^@%\{;\}]+?)\{/gm,function(t,n){var r=n.split(",").map(function(t){return t=t.trim(),t.match(/:host\b/)||t.match(new RegExp("^\\s*"+e+"\\b"))||t.match(/^\s*(?:(?:\d+%)|(?:from)|(?:to)|(?:@\w+)|\})\s*$/)?t:e+" "+t});return t.replace(n,r.join(","))}).replace(/:host\b/gm,e)+"\n"}).join("\n"))}function C(t){function e(){return"data"+(0===s?"":"$"+s)}function n(t){var n=void 0,r="",c=0;if(!t.match(J))return r+="'"+t.substr(c).replace(/\n/g,"").replace(/'/g,"\\'")+"', ";for(;n=J.exec(t);)if(!(n.index<c)){var u=t.substring(c,n.index).trim();u.length>0&&(r+="'"+u.replace(/\n/g,"").replace(/'/g,"\\'")+"', "),c=n.index+n[0].length;var l=n[1],f=l.substr(1);if("#"===l[0])r+="spread(toArray("+e()+", '"+f+"').map(function (entry, index, arr) {\n\t\t\t\t\t\tvar data$"+(s+1)+" = merge({}, data"+(0<=s?"":"$"+s)+", {'.': entry, '.index': index, '.length': arr.length}, entry);\n\t\t\t\t\t\treturn [",s+=1,a=!0,i=!0;else if("/"===l[0]){if(r+="'']; })), ",(s-=1)<0)throw new Error("Unexpected end of block: "+l.substr(1))}else"!"===l[0]?r+="":"^"===l[0]?(r+="(safeAccess("+e()+", '"+f+"') && (typeof safeAccess("+e()+", '"+f+"') === 'boolean' || safeAccess("+e()+", '"+f+"').length > 0)) ? '' : spread([1].map(function() { var data$"+(s+1)+" = merge({}, data"+(0<=s?"":"$"+s)+"); return [",i=!0,s+=1):"%"===l[0]?(r+=l.substr(1).split(/\s*,\s*/).map(function(t){return"renderStyle(safeAccess("+e()+", '"+t+"'), "+e()+")"}).join(" + "),o=!0):"+"===l[0]?r+="safeAccess("+e()+", '"+f+"'), ":"{"!==l[0]?(f=l,r+="safeAccess("+e()+", '"+f+"', true), "):r+="safeAccess("+e()+", '"+f+"'), "}return t.substr(c).length>0&&(r+="'"+t.substr(c).replace(/\n/g,"").replace(/'/g,"\\'")+"', "),r}var r={styles:[],helperFunctions:[G],tagName:"",render:"",functions:""},a=!1,o=!1,i=!1,c=void 0,u=0,s=0,l=[];if(t=t.replace(B,"").replace(/<(script|style)[^>]*?>((?:.|\n)*?)<\/\1>/gi,function(t,e,n){return"style"===e?r.styles.push(n):r.functions+=n.trim().replace(/;$/,""),""}).trim(),!t.match(Z))throw console.log(t),new Error("No proper component provided");for(r.tagName=t.match(/^<([\w_-]+)>/)[1].toLowerCase();c=Z.exec(t);)if(!(c.index<u)){var f=t.substring(u,c.index).replace(/^[ \t]+|[ \t]$/g," ").trim();if(u=c.index+c[0].length,f.length>0&&(r.render+=n(f)),c[2]!==r.tagName)if(c[1]){var d=l.pop();if(d!==c[2])throw new Error("Unexpected end of tag: "+c[2]+"; expected to end "+d);r.render=r.render.replace(/,\s*$/g,"")+")), "}else{l.push(c[2]);var h=function(t){for(var e="{",r=void 0;r=P.exec(t);)"{"!==e&&(e+=", "),e+='"'+r[1].toLowerCase()+'": '+n(r[2]||r[3]).replace(/,\s*$/,"");return e+"}"}(c[3]);r.render+="new Tag('"+c[2]+"', "+h,c[4]?(r.render+="), ",l.pop()):r.render+=", [].concat("}}if(l.length>0)throw new Error("Unclosed tags: "+l.join(", "));if(s>0)throw new Error("Unexpected end of block");return t.substr(u).trim().length>0&&(r.render+=n(t.substr(u).replace(/^[ \t]+|[ \t]$/g," ").trim())),r.render=r.render.replace(/,\s*$/g,""),a&&(r.helperFunctions.push(K),r.helperFunctions.push(X)),i&&r.helperFunctions.push(I),o&&r.helperFunctions.push(Q),r.functions=r.functions||"{}",r.styles=r.styles.length>0?"styles: "+JSON.stringify(r.styles)+",":"",r.helperFunctions=r.helperFunctions.join("\n"),W.replace(J,function(t,e){return r[e]})}function T(t,e){return[].slice.call(e.querySelectorAll(t))}var k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S=function(t){return"object"===(void 0===t?"undefined":k(t))},z=function(t){return"function"==typeof t},H=function(){},$={},M=[],F=[],q=function(t,e){return t},D={},V={},U={props:{},mount:H,unmount:H,render:H,getHost:function(){return this},setProps:function(e,n){var r=this.getHost();S(e)?t(r.props,e):r.props[e]=n,r.mounting||a("--zino-rerender-tag",r)}},R={resolveData:function(t,e,n){var a=r();return n&&delete V[n],V[a]=e,a}};o("--zino-initialize-node",E),o("--zino-unmount-tag",j),o("--zino-mount-tag",y);var Z=/<(\/?)([\w-]+)([^>]*?)(\/?)>/g,P=/([\w_-]+)=(?:'([^']*?)'|"([^"]*?)")/g,B=/<!--(?:[^-]|-[^-])*-->/g,J=/\{\{\s*([^\}]+)\s*\}\}\}?/g,G="function safeAccess(obj, attrs, escape) {\n\tif (!attrs) return obj;\n\tif (attrs[0] === '.') {\n\t\treturn obj[attrs];\n\t}\n\tattrs = attrs.split('.');\n\twhile (attrs.length > 0 && typeof (obj = obj[attrs.shift()]) !== 'undefined');\n\tif (typeof obj === 'string' && escape === true) {\n\t\treturn obj.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\"/g, '&quot;').replace(/>/g, '&gt;');\n\t} else if (typeof obj === 'function') {\n\t\treturn obj.call(instance);\n\t} else {\n\t\treturn obj || '';\n\t}\n}",X="function toArray(data, value) {\n\tvar dataValue = safeAccess(data, value);\n\tif (dataValue) {\n\t\tif (Object.prototype.toString.call(dataValue) === '[object Array]') {\n\t\t\treturn dataValue;\n\t\t} else if (typeof dataValue === 'function') {\n\t\t\treturn dataValue();\n\t\t} else return [dataValue];\n\t} else {\n\t\treturn [];\n\t}\n}",I="function spread(array) {\n\tvar result = [];\n\tarray.forEach(function(entry) {\n\t\tresult = result.concat(entry);\n\t});\n\treturn result;\n}",K="function merge(target) {\n\t[].slice.call(arguments, 1).forEach(function (arg) {\n\t\tfor (var all in arg) {\n\t\t\ttarget[all] = arg[all];\n\t\t}\n\t});\n\n\treturn target;\n}",Q="function renderStyle(value, context) {\n\tvar style = '';\n\t\ttransform = function(val) {\n\t\t\tif (typeof val === 'function') return transform(val.apply(context));\n\t\t\treturn val + (typeof val === 'number' && val !== null ? context.styles && context.styles.defaultUnit || 'px' : '');\n\t\t};\n\n\tif (typeof value === 'object') {\n\t\tfor (var all in value) {\n\t\t\tstyle += all.replace(/[A-Z]/g, g => '-' + g.toLowerCase()) + ':' + transform(value[all]) + ';';\n\t\t}\n\t}\n\n\treturn style;\n}",W="function(Tag) {\n\tvar instance = null;\n\t{{helperFunctions}}\n\n\treturn {\n\t\ttagName: '{{tagName}}',\n\t\t{{styles}}\n\t\trender: function(data) {\n\t\t\tinstance = this;\n\t\t\treturn [].concat({{render}})\n\t\t},\n\n\t\tfunctions: {{functions}}\n\t};\n}",Y=window.zinoTagRegistry||{},tt=void 0,et=[],nt=new MutationObserver(function(t){t.forEach(function(t){var e=t.addedNodes,n=t.removedNodes;e.length>0?[].forEach.call(e,function(t){(t.children&&T("*",t)||[]).concat(t).forEach(function(t){return a("--zino-mount-tag",t)})}):n.length>0&&[].forEach.call(n,function(t){(t.children&&T("[__ready]",t)||[]).concat(t).forEach(function(t){return a("--zino-unmount-tag",t)})})})}),rt=tt={on:o,one:c,off:i,trigger:a,fetch:function(t,e,n,r){if(n&&Y[t]&&!Y[t].callback)return e(Y[t],200);if(S(Y[t]))return Y[t].callback.push(e);if(Y[t]=r||{callback:[e]},!r){var a=new XMLHttpRequest;a.open("GET",t,!0),a.onreadystatechange=function(){if(4===a.readyState){var e=Y[t].callback;200===a.status&&(Y[t]=a.responseText),n||delete Y[t],e.forEach(function(t){return t(a.responseText,a.status)})}},a.send()}},import:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H,n=(this.path||"")+t;tt.fetch(n,function(t,r){var a=n.replace(/[^\/]+$/g,"");if(200===r){var o=void 0;try{0===t.trim().indexOf("<")&&(t=C(t)),o=new Function("return "+t.replace(/\bZino.import\s*\(/g,"Zino.import.call({path: "+JSON.stringify(a)+"}, ").trim().replace(/;$/,""))()}catch(t){throw t.message="Unable to import tag "+n.replace(/.*\//g,"")+": "+t.message,t}o&&b(o,document.body)}e()},!0)}};return window.Zino=tt,o("publish-style",function(t){if("string"==typeof t&&t.length>0){var e=document.createElement("style");e.innerHTML=t,t=e}t&&document.head.appendChild(t)}),o("--zino-rerender-tag",function(t){return et.indexOf(t)<0&&et.push(t)}),a("publish-style","[__ready] { contain: content; }"),T('[rel="zino-tag"]',document).forEach(function(t){return tt.import(t.href)}),nt.observe(document.body,{subtree:!0,childList:!0}),requestAnimationFrame(function t(){for(;et.length>0;)x(et.shift());requestAnimationFrame(t)}),rt}();
//# sourceMappingURL=zino.min.js.map